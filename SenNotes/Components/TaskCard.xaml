<UserControl x:Class="SenNotes.Components.TaskCard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converter="clr-namespace:SenNotes.Converter"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:SenNotes.Components"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             x:Name="Root"
             d:DesignHeight="200"
             d:DesignWidth="400"
             mc:Ignorable="d">
  <UserControl.Resources>
    <converter:ColorBrushConverter x:Key="ColorBrushConverter" />
  </UserControl.Resources>
  <Grid Background="{Binding BgColor, ElementName=Root, Converter={StaticResource ColorBrushConverter}}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <DockPanel LastChildFill="False" />
    <Border Grid.Row="1"
            Padding="10"
            Background="{Binding BgColor, ElementName=Root}">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="*" />
          <RowDefinition Height="Auto" />
          <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <StackPanel>
          <TextBlock FontSize="20"
                     FontWeight="ExtraBold"
                     Foreground="White"
                     Text="{Binding TaskModel.TaskTitle, ElementName=Root}"
                     TextWrapping="Wrap" />
          <Border BorderBrush="White"
                  BorderThickness="1"
                  Opacity="0.3" />
          <TextBlock Margin="0,10"
                     FontSize="15"
                     FontWeight="ExtraBold"
                     Foreground="White"
                     Text="{Binding TaskModel.TaskDetail, ElementName=Root}"
                     TextWrapping="Wrap" />
        </StackPanel>
        <Border Grid.Row="1">
          <local:TaskCardProgress ProgressStartTime="{Binding TaskModel.StartTime, ElementName=Root}"
                                  ProgressStopTime="{Binding TaskModel.EndTime, ElementName=Root}"
                                  Value="{Binding TaskModel.Progress, ElementName=Root}" />
        </Border>
        <Expander Grid.Row="2"
                  Background="Transparent"
                  Foreground="White">
          <StackPanel>
            <ItemsControl ItemsSource="{Binding TaskModel.Files, ElementName=Root}">
              <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                  <WrapPanel />
                </ItemsPanelTemplate>
              </ItemsControl.ItemsPanel>
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <local:FileBadge FileSource="{Binding}" Foreground="White" />
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
            <Border BorderBrush="White"
                    BorderThickness="1"
                    Opacity="0.3" />
            <TextBlock Text="{Binding TaskModel.InputMessage, ElementName=Root}" TextWrapping="Wrap" />
          </StackPanel>
        </Expander>
      </Grid>
    </Border>
  </Grid>
</UserControl>